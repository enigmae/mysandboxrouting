(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{181:function(e,t,n){e.exports=n(415)},195:function(e,t){},197:function(e,t){},209:function(e,t,n){},259:function(e,t){},260:function(e,t){},321:function(e,t){},415:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(175),s=n(10),i=n(15),l=n(27),c=n(26),o=n(28),u=n(16),h=n(21),d=n.n(h),m=n(41),p=n(176);n(209);function y(){return(y=Object(m.a)(d.a.mark(function e(t){var n,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("running search"),n=new p.RestClient("rest-samples","https://dev.virtualearth.net"),e.next=4,n.get("/REST/v1/Locations?q="+t+"&key=ArLJodQ7fEaQ2dfy3lIHWJrJILC35_Qj0EpT8TCy3ls96pl6sqCdlu18bo8j_tbM");case 4:return a=e.sent,e.abrupt("return",a.result.resourceSets[0].resources[0]);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var S=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).inputElement=void 0,n.handleKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),n.inputElement.blur()),""===n.state.SearchQuery&&n.setState({SearchResultVisible:!1})},n.handleSearchChanged=n.handleSearchChanged.bind(Object(u.a)(Object(u.a)(n))),n.handleSearchBlur=n.handleSearchBlur.bind(Object(u.a)(Object(u.a)(n))),n.handleKeyDown=n.handleKeyDown.bind(Object(u.a)(Object(u.a)(n)));var a="",r={Lat:0,Long:0};return e.SearchResult&&(e.SearchResult.SearchResult&&(a=e.SearchResult.SearchResult),e.SearchResult.Coords&&(r=e.SearchResult.Coords)),n.state={SearchResultVisible:!1,SearchQuery:e.SearchResult?e.SearchResult.SearchQuery:"",SearchResult:a,Coords:r},n.inputElement=null,n}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.inputElement.focus()}},{key:"handleSearchChanged",value:function(e){var t=this;this.setState({LastQuery:this.state.SearchQuery}),console.log("handlesearch changed last query is "+this.state.LastQuery),this.setState({SearchQuery:e.target.value,SearchResultVisible:!0}),function(e){return y.apply(this,arguments)}(e.target.value).then(function(e){console.log("last query is "+t.state.LastQuery),console.log("maps Response: "+JSON.stringify(e)),void 0!==e&&t.setState({SearchResult:e.name,Coords:{Lat:e.point.coordinates[0],Long:e.point.coordinates[1]}})})}},{key:"noticedChange",value:function(){return console.log("last query is "+this.state.LastQuery),console.log("search query is "+this.state.SearchQuery),console.log("search result is "+this.state.SearchResult),this.state.LastQuery!==this.state.SearchQuery?(this.setState({LastQuery:this.state.SearchQuery}),console.log("noticed change to "+this.state.LastQuery),!0):(console.log("noticed no change"),!1)}},{key:"handleSearchBlur",value:function(e){if(this.noticedChange()){var t=""===this.state.SearchQuery?"":this.state.SearchResult;this.setState({SearchQuery:t,SearchResultVisible:!1}),this.setState({LastQuery:t}),""!==t&&(this.setState({Submitted:!0}),this.props.searchResultsChanged({SearchResult:t,Coords:this.state.Coords,SearchQuery:this.state.SearchQuery}))}}},{key:"render",value:function(){var e,t=this;return this.state.SearchResultVisible&&(e=a.createElement("input",{type:"text",value:this.state.SearchResult,readOnly:!0})),a.createElement("div",null,a.createElement("input",{type:"text",value:this.state.SearchQuery,onChange:this.handleSearchChanged,onBlur:this.handleSearchBlur,onKeyDown:this.handleKeyDown,readOnly:this.state.Submitted,ref:function(e){return t.inputElement=e}}),a.createElement("br",null),e,a.createElement("br",null))}}]),t}(a.Component),f=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).handleSearchResultChanged=n.handleSearchResultChanged.bind(Object(u.a)(Object(u.a)(n))),n.state={SearchResults:[]},n}return Object(o.a)(t,e),Object(i.a)(t,[{key:"handleSearchResultChanged",value:function(e){console.log("handleSearchResultsChanged "),this.state.SearchResults.push(e),this.setState({SearchResults:this.state.SearchResults}),this.props.handleSearchCollectionChanged(this.state.SearchResults)}},{key:"render",value:function(){var e=a.createElement("li",null,a.createElement(S,{SearchResult:{SearchQuery:"",SearchResult:void 0},searchResultsChanged:this.handleSearchResultChanged})),t=[e],n=!0,r=!1,s=void 0;try{for(var i,l=this.state.SearchResults[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){i.value;t.push(e)}}catch(c){r=!0,s=c}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return a.createElement("ol",null,t)}}]),t}(a.Component),b=n(180),v=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.instructions.instructions.map(function(e){var t,n,r;return e.itineraryItem&&("Location:("+e.itineraryItem.location.latitude+", "+e.itineraryItem.location.longitude+")",e.itineraryItem.name&&(t=a.createElement("span",null,a.createElement("b",null,"Place:"),a.createElement("label",null,e.itineraryItem.name)))),e.endTime&&(n=a.createElement("span",null,a.createElement("b",null,"EndTime:")," ",e.endTime)),e.duration&&(r=a.createElement("span",null," ",a.createElement("b",null,"Duration:"),e.duration)),a.createElement("li",{key:e.startTime+e.instructionType},a.createElement("b",null,"Start:"),e.startTime," ",t,a.createElement("br",null),a.createElement("b",null," Type:"),e.instructionType," ",n," ",r)});return a.createElement("div",null,"Total time:",this.props.instructions.durationMinutes," minutes",a.createElement("div",null,e))}}]),t}(a.Component),g=n(177),E=n.n(g),R=function(e){function t(e){var n;Object(s.a)(this,t);return(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).state=Object(b.a)({},{collapsed:!0},n.calculateState()),n}return Object(o.a)(t,e),Object(i.a)(t,[{key:"calculateState",value:function(){return{totalHours:Math.floor(this.props.instructionSet.durationMinutes/60),totalMinutes:this.props.instructionSet.durationMinutes%60,totalDistance:this.props.instructionSet.distance}}},{key:"componentDidUpdate",value:function(){var e=this.calculateState();this.state.totalDistance==e.totalDistance&&this.state.totalHours==e.totalHours&&this.state.totalMinutes==e.totalMinutes||this.setState(e)}},{key:"render",value:function(){var e="Total Time:".concat(this.state.totalHours," hrs ").concat(this.state.totalMinutes.toFixed()," min Total Distance:").concat(this.props.instructionSet.distance.toFixed(1)," mi");return a.createElement(E.a,{trigger:e},a.createElement(v,{instructions:this.props.instructionSet}))}}]),t}(a.Component),j=n(178),O=n(179),C=n.n(O),w=function e(t,n,a){Object(s.a)(this,e),this.name=t,this.dwellTime=n,this.location=a},T=function(){function e(t){Object(s.a)(this,e),this.agent=void 0,this.instructions=void 0,this.distance=void 0,this.durationMinutes=void 0,this.instructions=t.instructions,this.agent=t.agent,this.distance=this.calcdistance(),this.durationMinutes=this.calcMinutes()}return Object(i.a)(e,[{key:"calcdistance",value:function(){for(var e=0,t=0;t<this.instructions.length;t++)this.instructions[t].distance&&(e+=this.instructions[t].distance);return 621371e-9*e}},{key:"calcMinutes",value:function(){return new C.a(new Date(this.instructions[this.instructions.length-1].startTime),new Date(this.instructions[0].startTime)).minutes()}}]),e}(),L=function(){function e(t){Object(s.a)(this,e),this.resourceSets=t}return Object(i.a)(e,[{key:"instructionSets",get:function(){return this.resourceSets[0].resources[0].agentItineraries.map(function(e){return new T(e)})}}]),e}(),k=function e(t,n){Object(s.a)(this,e),this.agents=t,this.itineraryItems=n},D=function(){function e(){Object(s.a)(this,e)}return Object(i.a)(e,[{key:"getItinerary",value:function(){var e=Object(m.a)(d.a.mark(function e(t){var n,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.searchResults.map(function(e){return new w(e.SearchResult,"00:"+t.dwellTime+":00",{latitude:e.Coords.Lat,longitude:e.Coords.Long})}),e.next=3,j.post("https://dev.virtualearth.net/REST/V1/Routes/OptimizeItinerary?key=ArLJodQ7fEaQ2dfy3lIHWJrJILC35_Qj0EpT8TCy3ls96pl6sqCdlu18bo8j_tbM",{resolveWithFullResponse:!1,json:new k([{name:"Kayode",shifts:[{startTime:"2019-11-16T08:00:00",endTime:"2019-11-16T18:00:00",endLocation:{latitude:t.endLocation.Lat,longitude:t.endLocation.Long},startLocation:{latitude:t.startLocation.Lat,longitude:t.startLocation.Long}}]}],n)});case 3:return a=e.sent,e.abrupt("return",new L(a.resourceSets));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),I=function(){function e(t){Object(s.a)(this,e),this.itinerary=t}return Object(i.a)(e,[{key:"getItineraries",value:function(){var e=Object(m.a)(d.a.mark(function e(t){var n,a,r,s,i,l,c,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=new Array,a=!0,r=!1,s=void 0,e.prev=4,i=t.searchResults[Symbol.iterator]();case 6:if(a=(l=i.next()).done){e.next=15;break}return c=l.value,e.next=10,this.itinerary.getItinerary({startLocation:c.Coords,searchResults:t.searchResults,dwellTime:t.dwellTime,endLocation:t.endLocation});case 10:o=e.sent,n.push(o);case 12:a=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),r=!0,s=e.t0;case 21:e.prev=21,e.prev=22,a||null==i.return||i.return();case 24:if(e.prev=24,!r){e.next=27;break}throw s;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return e.abrupt("return",{itineraries:n});case 30:case"end":return e.stop()}},e,this,[[4,17,21,29],[22,,24,28]])}));return function(t){return e.apply(this,arguments)}}()}]),e}(),Q=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).itineraryCollection=void 0,n.itinerary=void 0,n.itinerary=new D,n.itineraryCollection=new I(n.itinerary),n.handleDestinationChanged=n.handleDestinationChanged.bind(Object(u.a)(Object(u.a)(n))),n.state={DwellTime:15},n.handleDwellTimeChanged=n.handleDwellTimeChanged.bind(Object(u.a)(Object(u.a)(n))),n}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e;if(this.state&&this.state.ItineraryResponse&&this.state.ItineraryResponse.resourceSets)e=a.createElement(R,{instructionSet:this.state.ItineraryResponse.instructionSets[0]});else if(this.state&&this.state.ItinerariesResponse){var t=this.state.ItinerariesResponse.itineraries.map(function(e){return a.createElement("li",null,a.createElement(R,{instructionSet:e.instructionSets[0]}))});e=a.createElement("ol",null,t)}return a.createElement("div",null,a.createElement("div",null,"Enter destination:",a.createElement(S,{SearchResult:{SearchQuery:"",SearchResult:void 0},searchResultsChanged:this.handleDestinationChanged})),a.createElement("div",null,"Enter dwell time:",a.createElement("br",null),a.createElement("input",{value:this.state.DwellTime,onChange:this.handleDwellTimeChanged})),a.createElement(f,{handleSearchCollectionChanged:this.handleSingleItinerarySearch}),a.createElement("h1",null,"Itineraries:"),a.createElement("ol",null,e))}},{key:"handleSingleItinerarySearch",value:function(e){var t=this;this.itinerary.getItinerary({dwellTime:this.state.DwellTime,searchResults:e,startLocation:e[0].Coords,endLocation:this.state.Destination.Coords}).then(function(e){t.setState({ItineraryResponse:e})})}},{key:"handleMultipleItinerarySearch",value:function(e){var t=this;this.itineraryCollection.getItineraries({dwellTime:this.state.DwellTime,searchResults:e,endLocation:this.state.Destination.Coords}).then(function(e){t.setState({ItinerariesResponse:e})})}},{key:"handleDestinationChanged",value:function(e){console.log("handle destination changed:"+JSON.stringify(e)),this.setState({Destination:e})}},{key:"handleDwellTimeChanged",value:function(e){this.setState({DwellTime:e.target.value})}}]),t}(a.Component);var x=document.getElementById("root");Object(r.render)(a.createElement(function(){return a.createElement("div",{className:"App"},a.createElement("h1",null,"Hello CodeSandbox Test"),a.createElement("h2",null,"Enter locations"),a.createElement(Q,null))},null),x)}},[[181,2,1]]]);
//# sourceMappingURL=main.ba744b37.chunk.js.map